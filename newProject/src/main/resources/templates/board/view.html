<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>게시글 상세보기</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/4.5.2/css/bootstrap.min.css">
</head>
<body>

<div class="container mt-5">
    <h2>게시글 상세보기</h2>
    <table class="table" border="1">
        <input type="hidden" id="boardId" th:value="${boardId}">
        <input type="hidden" id="boardNo" th:value="${boardDto.boardNo}">
        <tr>
            <th>작성자</th>
            <td th:text="${boardDto.writerNm}"></td>
        </tr>
        <tr>
            <th>제목</th>
            <td th:text="${boardDto.subject}"></td>
        </tr>
        <tr>
            <th>내용</th>
            <td th:text="${boardDto.contents}"></td>
        </tr>
        <tr>
            <th>좋아요</th>
            <td th:text="${boardDto.likeCnt}"></td>
        </tr>
        <tr>
            <th>식비</th>
            <td th:text="${boardDto.foodCharge}"></td>
        </tr>
        <tr>
            <th>교통비</th>
            <td th:text="${boardDto.transportCharge}"></td>
        </tr>
        <tr>
            <th>기타 경비</th>
            <td th:text="${boardDto.etcCharge}"></td>
        </tr>
        <tr>
            <th>여행 예산</th>
            <td th:text="${boardDto.budget}"></td>
        </tr>
        <tr>
            <th>여행지</th>
            <td th:text="${boardDto.district}"></td>
        </tr>
        <tr>
            <th>방문일</th>
            <td th:text="${boardDto.visitDt}"></td>
        </tr>
        <tr>
            <th>조회수</th>
            <td th:text="${boardDto.hitCnt}"></td>
        </tr>

    </table>
    <a th:href="'/board/' + ${boardId} + '/list'" class="btn btn-secondary">목록으로 돌아가기</a><br>
    <a th:href="'/board/' + ${boardId} + '/write/' + ${boardDto.boardNo}" class="btn btn-secondary">수정하기</a><br>
    <button id="doDelete">삭제하기</button><br>
</div>

<script>
    document.getElementById('doDelete').addEventListener('click', function() {

        const data = {
            boardId: document.getElementById('boardId').value,
            boardNo: document.getElementById('boardNo').value,
        };
        fetch('../doDelete', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json' // 요청 헤더에 JSON 타입 지정
            },
            body: JSON.stringify(data) // 자바스크립트 객체를 JSON 문자열로 변환하여 전송
        })
            .then(response => response.text())
            .then(data => {
                if (data === "success") {
                    console.log('게시글 삭제 성공');
                    window.location.href="/";
                } else {
                    alert('게시글 삭제 실패');
                }
            })
            .catch(error => console.error("Error:", error));
    });
</script>

</body>
</html>
